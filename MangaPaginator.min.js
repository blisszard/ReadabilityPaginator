/*
 * The MIT License (MIT)
 * Copyright (c) 2017-08-16 Steven Chandswang
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 *     * Redistributions of source code must retain the above copyright notice,
 *       this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright notice,
 *       this list of conditions and the following disclaimer in the documentation
 *       and/or other materials provided with the distribution.
 *     * Neither the name of readability nor the names of its contributors
 *       may be used to endorse or promote products derived from this software
 *       without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * @Author: Steven Chandswang
 * @Date:   2017-08-16
 * @Last Modified by:   Steve Chan
 * @Last Modified time: 2020-03-26
 */
function initScript(e){var t="("+paginator.toString()+")();",n=document.createElement("script")
n.type="text/javascript",n.appendChild(document.createTextNode(t)),e("body").append(n)}function initStyle(){var e=document.createElement("style")
e.type="text/css",e.appendChild(document.createTextNode("#nextChapter{display:none} #pager_container{color:rgba(0,0,0,.87);background-color:#fff;transition:all 450ms cubic-bezier(.23,1,.32,1) 0s;box-sizing:border-box;box-shadow:rgba(0,0,0,.12) 0 1px 6px,rgba(0,0,0,.12) 0 1px 4px;border-radius:0;height:100%;overflow:hidden;position:absolute;padding:10px 10px 20px;left:50%;z-index:20}")),document.getElementsByTagName("head")[0].appendChild(e),jQuery(function(e){e("head").append('<link rel="stylesheet" href="https://use.fontawesome.com/releases/v4.6.3/css/font-awesome-css.min.css" media="all">'),e("head").append('<link href="https://cdn.jsdelivr.net/gh/blisszard/ReadabilityPaginator@master/manga.css" rel="stylesheet">'),e("head").append('<link href="https://cdn.jsdelivr.net/gh/blisszard/readability@development/font_style.css" rel="stylesheet">')})}function loadScript(e,t){var n=document.createElement("script")
n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,t())}:n.onload=function(){t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}console.clear()
var paginator=function(){jQuery(function(e){function t(){m=0,v=0,u=e(window).height(),h=e(window).width(),f=h-20,g=f-30,g=30,containerWidth=f+20,containerMarginLeft=-containerWidth/2,e("#pager_container").css({"margin-left":containerMarginLeft+"px",width:containerWidth+"px"}),e("#pages_5NPJADvYjZY").css({"-webkit-column-width":f+"px","-moz-column-width":f+"px","column-width":f+"px","-webkit-column-gap":g+"px","-moz-column-gap":g+"px","column-gap":g+"px"}),p(),s()}function n(e){if(null!=e.lastElementChild&&void 0!==e.childNodes){var t=e.lastElementChild
if(null!=t){e=n(t)}}return e}function i(){if(0==v){var t=n(e("#pages_5NPJADvYjZY")[0].lastElementChild),i=function(e){return e instanceof jQuery&&(e=e[0]),"#text"==e.nodeName&&(e=e.parentElement),e.getBoundingClientRect().left}(t)
v=Math.ceil(i/(f+g)),1==v&&(v=200)}}function a(){var n=e("#vungdoc,div.container-chapter-reader").children("img").map(function(e,t){return console.log(t.outerHTML),"<p>"+t.outerHTML+"</p>"}).get().join(""),i=e(".navi-change-chapter-btn-next").attr("href")
document.body.innerHTML='<div id="pager_container" style=""><div id="pages_5NPJADvYjZY" style="right: 0px; ">'+n+'</div></div><div id="nextChapterContent"></div><a id="nextPageUrl" href="'+i+'">Next</a>',t()}function o(){return m*(f+g)}function r(t){var n=new XMLHttpRequest
n.open("GET",t,!0),n.onload=function(){nextContent=n.responseText,e("#nextChapterContent").html(nextContent),e("#nextChapterContent").ready(function(){e("body").on("DOMSubtreeModified","#nextChapterContent",function(){void 0===e(".navi-change-chapter-btn-next").attr("href")&&alert("No More"),a()})}),history.pushState({},null,t)},n.send()}function d(){if(i(),console.log(e("#nextPageUrl").attr("href")),m+1>=v)return r(e("#nextPageUrl").attr("href")),!1
m++
p()
return!0}function c(){m>0&&(m--,p())}function p(){var t=o()
return e("#pages_5NPJADvYjZY").css({right:t+"px"}),t}function l(e,t,n){"number"!=typeof t&&(t=200)
var i=0
return function(){var a=+new Date
a>=i+t&&(i=a,e.apply(n||this,arguments))}}function s(){e("#pager_container").on("touchend click",l(function(t){var n=e(window).width(),i=t.pageX
if(void 0===i){if(void 0===t.originalEvent||void 0===t.originalEvent.touches[0])return
i=t.originalEvent.touches[0].pageX,t.stopPropagation(),t.preventDefault()}i<=n/5?c():d()||e("#pager_container").unbind()}))}var u,h,f,g,m=0,v=0
e(document).ready(function(){t()}),e(window).bind("keydown",function(e){37==e.keyCode?c():39==e.keyCode&&d()}),e(window).resize(function(){t()})})}
window.injectScript=function(e){var t=document.createElement("script")
t.type="text/javascript",t.src=e,document.getElementsByTagName("head")[0].appendChild(t)},window.injectJQ=function(){window.injectScript("https://use.fontawesome.com/webfontloader/1.6.24/webfontloader.js"),window.injectScript("https://use.fontawesome.com/bb7692e21a.js")},document.head.innerHTML='<meta charset="utf-8"><meta name="viewport" content="width=device-width" />',loadScript("https://code.jquery.com/jquery-2.1.0.min.js",function(){jQuery(function(e){var t=e("#vungdoc,div.container-chapter-reader,div.pages,div.ng-scope").children("img").map(function(e,t){return console.log(t.outerHTML),"<p>"+t.outerHTML+"</p>"}).get().join(""),n=e(".navi-change-chapter-btn-next").attr("href")
document.body.innerHTML='<div id="pager_container" style=""><div id="pages_5NPJADvYjZY" style="right: 0px; ">'+t+'</div></div><div id="nextChapterContent"></div><a id="nextPageUrl" href="'+n+'">Next</a>',initStyle(),initScript(e)})})
